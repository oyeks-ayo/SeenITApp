{% for p in projects %}
<div class="col-xl-4 col-lg-6 col-md-6 mb-4 fade-in">
    <div class="project-card card-custom">
        <div class="project-media">
            {% if p.media and p.media[0].file_type == 'image' %}
                <img src="/static/uploads/project/project_pix/{{ p.media[0].filename }}" 
                     alt="{{ p.title }}" class="img-fluid">
            {% elif p.media and p.media[0].file_type == 'video' %}
                <video controls class="img-fluid">
                    <source src="/static/uploads/project/project_video/{{ p.media[0].filename }}" type="video/mp4">
                </video>
            {% else %}
                <div class="d-flex align-items-center justify-content-center h-100 bg-light">
                    <i class="fas fa-image fa-3x text-muted"></i>
                </div>
            {% endif %}
            <div class="position-absolute top-0 start-0 m-3">
                <img src="/static/uploads/profile_pix/{{ p.user.profile.profile_pix if p.user.profile.profile_pix else 'avatar.jpg' }}" 
                     alt="{{ p.user.username }}" class="rounded-circle" width="40" height="40">
            </div>
        </div>
        <div class="project-info">
            <div class="d-flex justify-content-between align-items-start mb-2">
                <div>
                    <h5 class="fw-bold mb-1">{{ p.title }}</h5>
                    <p class="mb-1 small">
                        <a href="/profile/page/{{ p.user.id }}" class="text-dark fw-medium">{{ p.user.fname }} {{ p.user.lname }}</a>
                    </p>
                </div>
                {% if p.user.profile.category %}
                <span class="badge-custom">{{ p.user.profile.category.name }}</span>
                {% endif %}
            </div>
            <p class="project-desc text-muted">{{ p.description | truncate(100) }}</p>
            <div class="d-flex justify-content-between align-items-center mt-3">
                <span class="text-muted small"><i class="far fa-clock me-1"></i> {{ p.datereg_project|time_ago }}</span>
                <a href="/project/{{ p.user.id }}/{{ p.title }}/{{ p.profile_id }}/" class="btn btn-sm btn-outline-primary">See More</a>
            </div>
        </div>
        <div class="project-actions">
            <button class="btn btn-sm btn-link text-muted p-0"><i class="far fa-heart me-1"></i> 124</button>
            <button class="btn btn-sm btn-link text-muted p-0"><i class="far fa-comment me-1"></i> 18</button>
            <button class="btn btn-sm btn-link text-muted p-0"><i class="far fa-bookmark"></i></button>
        </div>
    </div>
</div>
{% else %}
<div class="col-12">
    <div class="text-center py-5">
        <i class="fas fa-users fa-3x text-muted mb-3"></i>
        <h4 class="text-muted">No projects found</h4>
        <p>Be the first to share your work!</p>
    </div>
</div>
{% endfor %}